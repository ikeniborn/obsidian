--- a/src/ServerPeer.ts
+++ b/src/ServerPeer.ts
@@ -4,10 +4,10 @@ import { EVENT_LAYOUT_READY, Synchromesh } from "../lib/src/common/events.ts";

 export async function startServer(conf: ServerP2PSetting) {
     const { globalVariables } = await Synchromesh();
-    globalVariables.set("settings", conf);
+    // Set P2P_Enabled BEFORE saving to globalVariables (fix for P2P disabled bug)
     conf.P2P_Enabled = true;
     conf.P2P_AutoStart = true;
     conf.P2P_AutoBroadcast = true;
+    globalVariables.set("settings", conf);

     const synchronised = cmdSyncShim.init();
