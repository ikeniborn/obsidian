# /opt/notes/.env Configuration File

metadata:
  id: "config:env-file"
  name: "Environment Configuration File"
  file_path: "/opt/notes/.env"
  type: "configuration"
  status: "active"
  last_updated: "2025-11-16"

description:
  summary: "Central environment configuration file for all Obsidian Sync Server components"
  purpose: "Store runtime configuration and credentials"
  security: "chmod 600 (owner read/write only)"

structure:
  sections:
    - section: "CouchDB Credentials"
      variables:
        - name: "COUCHDB_USER"
          default: "admin"
          required: true

        - name: "COUCHDB_PASSWORD"
          generation: "openssl rand -hex 32"
          length: "64 characters (256-bit entropy)"
          required: true

    - section: "Domain and SSL"
      variables:
        - name: "NOTES_DOMAIN"
          example: "notes.example.com"
          required: true

        - name: "CERTBOT_EMAIL"
          example: "admin@example.com"
          required: true

    - section: "Network Configuration"
      variables:
        - name: "NETWORK_MODE"
          values: ["shared", "isolated", "custom"]

        - name: "NETWORK_NAME"
          example: "obsidian_network"

        - name: "NETWORK_EXTERNAL"
          values: ["true", "false"]

        - name: "NETWORK_SUBNET"
          example: "172.25.0.0/16"
          note: "Only for isolated mode"

    - section: "S3 Backup (Optional)"
      variables:
        - name: "S3_ACCESS_KEY_ID"
          required: false

        - name: "S3_SECRET_ACCESS_KEY"
          required: false
          security: "Sensitive - chmod 600"

        - name: "S3_BUCKET_NAME"
          example: "my-couchdb-backups"

used_by:
  - "component:couchdb"
  - "component:nginx"
  - "component:docker-network"
  - "component:s3-storage"
  - "script:setup"
  - "script:deploy"

security:
  permissions: "chmod 600 (owner only)"
  excluded_from_git: true
  credential_management: "Generated by setup.sh"

references:
  prd_sections:
    - "FR-002: Interactive Configuration"
